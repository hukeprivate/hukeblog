function Drive(){return this instanceof Drive?void this.init():new Drive}var TimeUtils=$.getTimeUtils();Drive.prototype={username:$.getCookie("username"),init:function(){this.uploadClickEvent(),this.editClickEvent(),this.iconClickEvent(),this.deleteClickEvent(),$.hkLoading(),this.fetchFileList()},iconClickEvent:function(){$(".file-list").on("click",".icon-wrapper",function(){var e=$(this);location.href="http://kenote.me:8080/hukeblog/file/download/?filename="+e.attr("data-filename")})},editClickEvent:function(){$(".btn-edit").click(function(){$(".icon-close").toggleClass("active")})},deleteClickEvent:function(){var e=this;$(".file-list").on("click",".icon-close",function(){var t=$(this).siblings(".txt").html();e.deleteFile(t)})},uploadClickEvent:function(){var e=this;e.token,e.username;$("button.upload").click(function(t){t.preventDefault();var i=new FormData($("#uploadForm")[0]),n=$("#uploadForm input").val();if(!n)return void $.hkPopupTip("please choose a file to upload!",2e3);var o=e;$.ajax({url:"http://kenote.me:8080/hukeblog/file/upload",type:"POST",data:i,cache:!1,contentType:!1,dataType:"text",processData:!1,headers:{Authorization:"Bearer "+$.getCookie("token")},success:function(e){console.log("upload res:",e),o.fetchFileList(),$.hkPopupTip(e,2500)},error:function(e){console.log("error res:",e),$.hkPopupTip(e.responseText,1e3)}})})},fetchFileList:function(){var e=this;$.hkAjax("get","/file/filelist",{},function(t){$.disHkLoading();var i=e.addExtForRes(t);console.log(i),e.render(i)})},render:function(e){var t=template("tpl-file-list",e);$(".files-area .file-list").html(t)},addExtForRes:function(e){var t={filelist:[]};return e.filelist&&e.filelist.constructor===Array&&e.filelist.forEach(function(e,i){var n=new Object;n.name=e,n.ext=e.split(".").pop(),t.filelist.push(n)}),t},deleteFile:function(e){var t=this;$.hkAjax("get","/file/delete",{filename:e},function(e){console.log("delete res:",e),$.hkPopupTip(e,2500),t.fetchFileList()},"text")}},Object.defineProperty(Drive.prototype,"constructor",{enumerable:!1,value:Drive}),$(function(){new Drive});