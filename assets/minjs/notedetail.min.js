function Notedetail(){return this instanceof Notedetail?void this.init():new Notedetail}Notedetail.prototype={fileId:$.getUrlPara("fileId"),TimeUtils:$.getTimeUtils(),init:function(){$.hkLoading(),this.fetchFile(this.fileId)},fetchFile:function(e){var i=this;$.hkAjax("get","/notes/getfile",{fileId:e},function(e){$.disHkLoading(),i.addPath2(e),i.addDate2(e),i.render(e)})},addPath2:function(e){e.path2=this.getPathObjArr(e.path)},getPathObjArr:function(e){var t=[];if(e){var n=e.slice(1,-1),l=n.split(", ");for(len=l.length,i=0;i<len;i++){var o=new Object,s=l[i].split("="),d=s[0],a=s[1]?s[1]:"";o.noteId=d,o.title=a,t.push(o)}}return t.reverse()},addDate2:function(e){e.createdDate2=TimeUtils.getDateByTimeStampWithDash(e.createdDate),e.lastModifiedDate2=TimeUtils.getDateByTimeStampWithDash(e.lastModifiedDate)},render:function(e){console.log(e),document.title=$.renderDocTitle(e.title);var i=template("tpl-note-info",e);$(".note-info-txt").html(i),$.loadScript("/assets/js/lib/highlight.min.js",function(){hljs.initHighlighting.called=!1,hljs.initHighlighting()}),$.addDsqScript(),$(".m-preview .title").prepend(e.title),$(".title .icon-compose").click(function(){window.location.href="/notes/edit.html?fileId="+e.noteId}),this.compile(e.content),this.initDOM(),this.likesFunc(),this.addViewCount()},initDOM:function(){$likeBtn=$(".like .icon-like")},likesFunc:function(){this.hasLiked()&&$likeBtn.addClass("red"),this.likesEvent()},hasLiked:function(){var e=$.getCookie("fileIdLiked"),i=e.split(",");return i.indexOf(this.fileId)>=0},likesEvent:function(){var e=this;$likeBtn.off("click"),$likeBtn.click(function(){e.hasLiked()?$.hkPopupTip("you have already liked this post!"):($likeBtn.attr("disabled",!0),e.likesFile())})},likesFile:function(){var e=this;$.hkAjax("post","/notes/likesfile",{fileId:e.fileId},function(i){$likeBtn.attr("disabled",!1),console.log("likes file res:",i),$likeBtn.addClass("red"),e.setLikesCookie(),e.likesEvent()},"text")},setLikesCookie:function(){var e=$.getCookie("fileIdLiked"),i=e.split(",");i.push(this.fileId),$.setCookie("fileIdLiked",i,31)},compile:function(e){var i=e,t=marked(i);document.getElementById("output").innerHTML=t},addViewCount:function(){var e=this;$.hkAjax("post","/notes/viewsfile",{fileId:e.fileId},function(e){console.log("views file res:",e)},"text")}},Object.defineProperty(Notedetail.prototype,"constructor",{enumerable:!1,value:Notedetail}),$(function(){new Notedetail});