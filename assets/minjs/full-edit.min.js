function FullEdit(){return this instanceof FullEdit?void this.init():new FullEdit}FullEdit.prototype={fileId:$.getUrlPara("fileId"),init:function(){this.initDOM(),this.setHeights(),this.doneTyingEvent(),this.getFile(),this.listenEscPress(),this.setTabEvent()},setTabEvent:function(){$content.keydown(function(t){if(9===t.keyCode){var e=this.selectionStart,i=this.selectionEnd;console.log(e,i);var n=$(this),l=n.val();n.val(l.substring(0,e)+"\t"+l.substring(i)),this.selectionStart=this.selectionEnd=e+1,t.preventDefault()}})},setHeights:function(){var t=$(window).height()-$("header").height();$(".m-edit-preview-cont").height(t)},initDOM:function(){$title=$("#title"),$content=$("#content"),$preTitle=$("#pre-title"),$preContent=$("#pre-content")},getFile:function(){var t=this;$.hkAjax("get","/notes/getfile",{userId:1,fileId:t.fileId},function(e){console.log("res file:",e),$title.val(e.title),$content.val(e.content),t.compile()})},compile:function(){var t=$title.val(),e=$content.val(),i=marked(t),n=marked(e);$preTitle.html(i),$preContent.html(n),$.loadScript("/assets/js/lib/highlight.min.js",function(){hljs.initHighlighting.called=!1,hljs.initHighlighting()})},doneTyingEvent:function(){var t=this;$title.donetyping(function(){t.updateFile()},200),$title.on("keyup",function(){t.compile()}),$content.donetyping(function(){t.updateFile()},200),$content.on("keyup",function(){t.compile()})},updateFile:function(){var t={userId:1,noteId:this.fileId,title:$title.val(),content:$content.val()};$.hkAjax("post","/notes/updatefile",t,function(t){},"text")},listenEscPress:function(){var t=this;$(document).keyup(function(e){27==e.keyCode&&(window.location.href="/notes/edit.html?fileId="+t.fileId)})}},Object.defineProperty(FullEdit.prototype,"constructor",{enumerable:!1,value:FullEdit}),$(function(){new FullEdit});