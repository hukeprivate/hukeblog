function Index(){return this instanceof Index?void this.init():new Index}var TimeUtils=$.getTimeUtils();Index.prototype={pageIndex:0,pageSize:5,pageLoadEventInited:!1,pageCount:0,init:function(){$.hkLoading(),$.toTop(),this.reqJinshanDaily(),this.reqPostList(),this.postVisits()},postVisits:function(){$.hkAjax("get","/visitors/visits",{},function(e){console.log("visits res:",e)},"text")},prcsResTime:function(e){$.each(e.notes,function(e,t){t.timeLabel=TimeUtils.getLabelByTimestamp(t.createdDate).toUpperCase()},"text")},reqPostList:function(e){var t=this;$.hkAjax("get","/notes/latestposts",{pageIndex:t.pageIndex,pageSize:t.pageSize},function(i){$.disHkLoading(),e&&e.length>0&&(e.find(".txt").show(),e.find("img").hide()),console.log(i),t.prcsResTime(i);var n=template("tpl-latest-posts",i);$(".m-post-list").find(".list-cont").append(n),t.pageLoadEventInited||(t.pageCount=i._count,t.pageLoadEventInited=!0,t.loadMoreEvent())})},loadMoreEvent:function(){var e=this;$(".load-more-btn").ripples(),$(".load-more-btn").click(function(){if(e.pageIndex++,e.pageIndex<e.pageCount){var t=$(this);t.find(".txt").hide(),t.find("img").show(),e.reqPostList(t)}else $.hkPopupTip("No more posts available :)",3e3)})},reqJinshanDaily:function(){var e=[],t=TimeUtils.getCrtTimeStamp(),i=t-864e5,n=i-864e5,s=(new Date(t),TimeUtils.getDateByTimeStamp(t)),a=TimeUtils.getDateByTimeStamp(i),o=TimeUtils.getDateByTimeStamp(n),d=this,c="/jinshan/get";$.hkAjax("get",c,{date:s},function(s){var l=new Date(t).toDateString();s.engDate=l.substring(0,l.length-5),e.push(s),$.hkAjax("get",c,{date:a},function(t){var s=new Date(i).toDateString();t.engDate=s.substring(0,s.length-5),e.push(t),$.hkAjax("get",c,{date:o},function(t){var i=new Date(n).toDateString();t.engDate=i.substring(0,i.length-5),e.push(t);var s={jinshanList:e},a=template("tpl-jinshan",s);$(".m-daily").html(a),d.initJinshanEvent()})})})},initJinshanEvent:function(){$(".icon-collapse").click(function(){$(".m-daily").addClass("collapse"),$(".icon-expand").show(),$(".icon-collapse").hide()}),$(".icon-expand").click(function(){$(".m-daily").removeClass("collapse"),$(".icon-expand").hide(),$(".icon-collapse").show()}),this.initCarouselEvent()},initCarouselEvent:function(){function e(){d.attr("disabled",!1),c.attr("disabled",!1),n=setInterval(function(){i.eq(a).fadeOut(1e3),a+1==s?(i.eq(0).fadeIn(1e3),o.eq(0).addClass("current").siblings().removeClass("current")):(i.eq(a+1).fadeIn(1e3),o.eq(a+1).addClass("current").siblings().removeClass("current")),a++,a==s&&(a=0)},6e3)}var t=$(".m-daily"),i=t.find(".wrapper");i.eq(0).show();var n,s=i.length,a=0,o=t.find(".circle"),d=$(".right-btn"),c=$(".left-btn");e(),o.click(function(){if(a!=$(this).index()){clearInterval(n);var t=$(this).index();i.hide(),i.eq(t).fadeIn(),o.eq(t).addClass("current").siblings().removeClass("current"),a=t,setTimeout(e,1e3)}}),d.click(function(){$(this).attr("disabled",!0),c.attr("disabled",!0),clearInterval(n),a++,a==s&&(a=0),i.hide(),i.eq(a).fadeIn(),o.eq(a).addClass("current").siblings().removeClass("current"),setTimeout(e,1e3)}),c.click(function(){$(this).attr("disabled",!0),d.attr("disabled",!0),clearInterval(n),a--,a<0&&(a=s-1),i.hide(),i.eq(a).fadeIn(),o.eq(a).addClass("current").siblings().removeClass("current"),setTimeout(e,1e3)}),this.resizeDailyImg()},resizeDailyImg:function(){var e=($(window),$(".m-daily")),t=$(".right-btn"),i=$(".left-btn"),n=window.innerWidth>0?window.innerWidth:screen.width;e.width();if(n>=1200){var s=.4*n;e.height(s),t.add(i).height(s/2),e.find(".m-txt-cont").css("top","26%"),e.find(".m-dateline").css("line-height","2.8")}else if(n>=980&&n<1200){$(".m-txt-cont").css("top","14%");var s=.4*n+"px";e.height(s),t.add(i).height(s/2)}else if(n>=768&&n<980)e.find(".m-txt-cont").css("top","20%");else if(n>=480&&n<768){var s=1*n+"px";e.height(s),t.add(i).height(s/2),e.find(".m-date-line").css("font-size","40px"),e.find(".m-content").css("font-size","22px"),e.find(".m-note").css("font-size","28px")}else if(n>=380&&n<480){var s=.8*n+"px";e.height(s),t.add(i).height(s/2),e.find(".m-dateline").css("font-size","26px"),e.find(".m-content").css("font-size","18px"),e.find(".m-note").css("font-size","14px"),e.find(".m-txt-cont").css("top","20%"),e.find(".m-circle-cont").css("bottom","20px")}else if(n>320&&n<380){var s=1*n+"px";e.height(s),t.add(i).height(s/2),e.find(".m-dateline").css("font-size","20px"),e.find(".m-content").css("font-size","18px"),e.find(".m-note").css("font-size","14px"),e.find(".m-txt-cont").css("top","20%"),e.find(".m-circle-cont").css("bottom","20px")}else{var s=1*n+"px";e.height(s),t.add(i).height(s/2),e.find(".label").css("font-size","20px"),e.find(".m-dateline").css("font-size","20px"),e.find(".m-content").css("font-size","16px"),e.find(".m-note").css("font-size","12px"),e.find(".m-txt-cont").css("top","20%"),e.find(".m-circle-cont").css("bottom","20px")}}},Object.defineProperty(Index.prototype,"constructor",{enumerable:!1,value:Index}),$(function(){new Index});